<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XeinStore - Digital Game Codes</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family:'Segoe UI', sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; color:#222; }
.header { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding:1rem 0; box-shadow:0 2px 20px rgba(0,0,0,0.1); position:sticky; top:0; z-index:100; }
.nav { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:0 2rem; }
.logo { font-size:1.6rem; font-weight:700; background:linear-gradient(45deg,#667eea,#764ba2); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.cart-btn { background:#667eea; color:#fff; border:none; padding:.6rem 1rem; border-radius:20px; cursor:pointer; font-weight:600; display:flex; gap:.5rem; align-items:center;}
.cart-count { background:#ff4757; color:white; border-radius:50%; padding:.15rem .45rem; font-size:.8rem; }
.container { max-width:1200px; margin:1.5rem auto; padding:1rem; }
.hero { text-align:center; color:white; margin-bottom:1.5rem; }
.hero h1 { font-size:2.4rem; text-shadow:2px 2px 4px rgba(0,0,0,0.25); margin-bottom:.3rem; }
.products-grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap:1.25rem; }
.product-card { background: rgba(255,255,255,0.95); border-radius:12px; overflow:hidden; box-shadow:0 8px 25px rgba(0,0,0,0.08); transition:transform .18s; }
.product-card:hover { transform: translateY(-6px); }
.product-image { height:150px; display:flex; align-items:center; justify-content:center; font-size:3rem; color:white; background: linear-gradient(45deg,#667eea,#764ba2); }
.product-info { padding:1rem; }
.product-title { font-weight:700; color:#2d3748; margin-bottom:.35rem; }
.product-platform { color:#667eea; margin-bottom:.6rem; }
.duration-selector select { width:100%; padding:.45rem; border-radius:6px; border:1px solid #e6eef8; margin-bottom:.5rem; }
.duration-price { color:#667eea; font-weight:700; margin-bottom:.6rem; }
.add-to-cart { width:100%; padding:.6rem; border-radius:8px; background:#667eea; color:white; border:none; cursor:pointer; font-weight:700; }

.cart-sidebar { position: fixed; right: -420px; top: 0; width: 420px; height: 100vh; background: white; box-shadow: -5px 0 20px rgba(0,0,0,.12); transition: right .28s; z-index:900; overflow-y:auto; }
.cart-sidebar.open { right: 0; }
.cart-header { padding:1rem; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; }
.close-cart { background:none; border:none; font-size:1.3rem; cursor:pointer; }
.cart-items { padding:1rem; }
.cart-item { display:flex; justify-content:space-between; gap:10px; padding:.75rem 0; border-bottom:1px solid #f1f3f5; align-items:center; }
.cart-total { padding:1rem; border-top:2px solid #eee; font-weight:800; font-size:1.05rem; }
.checkout-btn { width:100%; padding:1rem; border-radius:10px; background:#00d4aa; color:white; border:none; font-weight:800; cursor:pointer; margin-top:.8rem; }

.modal-backdrop { position:fixed; inset:0; background: rgba(0,0,0,0.55); display:none; align-items:center; justify-content:center; z-index:10000; padding:1rem; }
.modal-backdrop.open { display:flex; }
.modal { width:100%; max-width:720px; background:white; border-radius:12px; overflow:auto; max-height:90vh; }
.modal-header { padding:1rem; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; }
.modal-body { padding:1rem; display:grid; gap:1rem; grid-template-columns: 1fr 320px; }
.modal-column { padding:.5rem; }
.field { margin-bottom:.6rem; }
input[type="text"] { width:100%; padding:.6rem; border-radius:8px; border:1px solid #e6edf7; }
.btn { padding:.6rem .9rem; border-radius:8px; border:none; cursor:pointer; }
.btn-primary { background:#667eea; color:white; font-weight:700; }
.btn-success { background:#00d4aa; color:white; font-weight:800; }

.notification { position: fixed; bottom: 20px; left: 20px; background: #00d4aa; color: white; padding: 1rem; border-radius: 8px; z-index:10000; }

@media (max-width:900px) { .modal-body { grid-template-columns: 1fr; } .cart-sidebar { width:100%; right:-100%; } .cart-sidebar.open { right:0; width:100%; } }
</style>
</head>
<body>

<header class="header">
  <nav class="nav">
    <div class="logo">ðŸŽ® XeinStore</div>
    <div style="display:flex; gap:.6rem; align-items:center;">
      <button class="cart-btn" onclick="toggleCart()">Cart <span class="cart-count" id="cart-count">0</span></button>
    </div>
  </nav>
</header>

<main class="container">
  <div class="hero">
    <h1>Digital Game Codes</h1>
    <p>Instant delivery â€¢ USDT (TRC20) â€¢ Best prices</p>
  </div>
  <div class="products-grid" id="products-grid"></div>
</main>

<aside class="cart-sidebar" id="cart-sidebar">
  <div class="cart-header">
    <h3>Shopping Cart</h3>
    <button class="close-cart" onclick="toggleCart()">Ã—</button>
  </div>
  <div class="cart-items" id="cart-items">
    <p style="text-align:center; color:#666; padding:2rem;">Your cart is empty</p>
  </div>
  <div class="cart-total" id="cart-total" style="display:none;">Total: $0.00</div>
  <div style="padding:1rem;">
    <button id="checkout-btn" class="checkout-btn" style="display:none;" onclick="openCheckoutModal()">Checkout</button>
  </div>
</aside>

<!-- Checkout modal -->
<div class="modal-backdrop" id="checkout-modal">
  <div class="modal" role="dialog">
    <div class="modal-header">
      <h3>Checkout</h3>
      <div><button class="btn" onclick="closeCheckoutModal()">Close</button></div>
    </div>
    <div class="modal-body">
      <div class="modal-column">
        <div class="field">
          <label>Telegram username (required)</label>
          <input id="buyer-telegram" type="text" placeholder="@username"/>
        </div>
        <p><strong>NOTE:</strong> Please be reminded to screenshot your crypto payment.</p>
        <div style="margin-top:.6rem; display:flex; gap:.6rem;">
          <button class="btn btn-primary" onclick="preparePayment()">Continue to Payment</button>
          <button class="btn" onclick="closeCheckoutModal()">Cancel</button>
        </div>
      </div>
      <div class="modal-column">
        <div id="payment-pane" style="display:none;">
          <div style="border:1px dashed #e6edf7; padding:1rem; border-radius:8px;">
            <div class="network-label">Wallet Address:</div>
            <div id="wallet-address" style="font-weight:700;">TEwKbkNdXqvNUG951nYTCRF6UjLGBn7pqc</div>
            <div style="margin-top:.6rem; display:flex; gap:.5rem; justify-content:center;">
              <button class="btn btn-success" onclick="markAsPaid()">I Paid</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="notification-container"></div>

<script>
let cart = [];
const products = [
  { id:1, title:"Xein Pubg Key", platform:"Digital Key", pricing:{"1_day":{price:5},"3_days":{price:8},"7_days":{price:12},"30_days":{price:23}}, icon:"ðŸŽ¯" },
  { id:2, title:"Xein Delta Force Key", platform:"Digital Key", pricing:{"1_day":{price:4},"3_days":{price:7},"7_days":{price:11},"30_days":{price:22}}, icon:"âš¡" }
];

// render product cards
function renderProducts() {
  const grid = document.getElementById('products-grid');
  grid.innerHTML = '';
  products.forEach(product=>{
    let optionsHTML = '';
    for(const [key,v] of Object.entries(product.pricing)){
      const label = key.replace(/_/g,' ').replace(/\b\w/g,l=>l.toUpperCase());
      optionsHTML += `<option value="${key}">${label} - $${v.price}</option>`;
    }
    const card = document.createElement('div');
    card.className='product-card';
    card.innerHTML=`
      <div class="product-image">${product.icon}</div>
      <div class="product-info">
        <div class="product-title">${product.title}</div>
        <div class="product-platform">${product.platform}</div>
        <div class="duration-selector">
          <select id="duration-${product.id}" onchange="updatePrice(${product.id})">
            ${optionsHTML}
          </select>
          <div class="duration-price" id="price-${product.id}">$${product.pricing["1_day"].price} USDT</div>
        </div>
        <button class="add-to-cart" onclick="addToCart(${product.id})">Add to Cart</button>
      </div>
    `;
    grid.appendChild(card);
  });
}

function updatePrice(productId){
  const select = document.getElementById(`duration-${productId}`);
  const priceDisplay = document.getElementById(`price-${productId}`);
  const product = products.find(p=>p.id===productId);
  priceDisplay.textContent=`$${product.pricing[select.value].price} USDT`;
}

function addToCart(productId){
  const product = products.find(p=>p.id===productId);
  const select = document.getElementById(`duration-${productId}`);
  const selectedDuration = select.value;
  const price = product.pricing[selectedDuration].price;
  const existing = cart.find(i=>i.id===productId && i.selectedDuration===selectedDuration);
  if(existing) existing.quantity++;
  else cart.push({ id:product.id, title:product.title, selectedDuration, durationLabel:select.options[select.selectedIndex].text, price, quantity:1 });
  updateCartUI();
  showNotification('Added to cart âœ…');
}

// --- UI helpers ---
function showNotification(msg){
  const n = document.createElement('div'); n.className='notification'; n.textContent=msg;
  document.body.appendChild(n);
  setTimeout(()=>{ if(n.parentNode) n.parentNode.removeChild(n); }, 3000);
}

function toggleCart(){
  document.getElementById('cart-sidebar').classList.toggle('open');
}

function updateCartUI(){
  const cartCount=document.getElementById('cart-count');
  const cartItems=document.getElementById('cart-items');
  const cartTotalEl=document.getElementById('cart-total');
  const checkoutBtn=document.getElementById('checkout-btn');
  const totalItems=cart.reduce((s,i)=>s+i.quantity,0);
  const totalPrice=cart.reduce((s,i)=>s+i.price*i.quantity,0);
  cartCount.textContent=totalItems;
  if(cart.length===0){
    cartItems.innerHTML='<p style="text-align:center;color:#666;padding:2rem;">Your cart is empty</p>';
    cartTotalEl.style.display='none';
    checkoutBtn.style.display='none';
  } else {  let html='';
  for(const item of cart){
    html+=`
      <div class="cart-item">
        <div style="flex:1;">
          <div style="font-weight:700;">${item.title}</div>
          <div style="font-size:.9rem;color:#666;">${item.durationLabel}</div>
          <div style="font-size:.9rem;color:#667eea;">$${item.price} each x${item.quantity}</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:.4rem;">
          <button onclick="decreaseQty(${item.id},'${item.selectedDuration}')" style="padding:.35rem .5rem;">âˆ’</button>
          <button onclick="increaseQty(${item.id},'${item.selectedDuration}')" style="padding:.35rem .5rem;">+</button>
          <button onclick="removeFromCart(${item.id},'${item.selectedDuration}')" style="background:#ff4757;color:white;border:none;border-radius:6px;padding:.35rem .5rem;cursor:pointer;">Remove</button>
        </div>
      </div>
    `;
  }
  cartItems.innerHTML=html;
  cartTotalEl.style.display='block';
  cartTotalEl.textContent=`Total: $${totalPrice.toFixed(2)} USDT`;
  checkoutBtn.style.display='block';
}

function decreaseQty(id,dur){
  const idx=cart.findIndex(i=>i.id===id && i.selectedDuration===dur);
  if(idx>-1){ cart[idx].quantity=Math.max(1,cart[idx].quantity-1); updateCartUI(); }
}
function increaseQty(id,dur){
  const idx=cart.findIndex(i=>i.id===id && i.selectedDuration===dur);
  if(idx>-1){ cart[idx].quantity++; updateCartUI(); }
}
function removeFromCart(id,dur){
  cart=cart.filter(i=>!(i.id===id && i.selectedDuration===dur));
  updateCartUI();
}

// ---------- Checkout ----------
function openCheckoutModal(){
  if(cart.length===0){ alert('Cart is empty.'); return; }
  document.getElementById('checkout-modal').classList.add('open');
}

function closeCheckoutModal(){
  document.getElementById('checkout-modal').classList.remove('open');
  document.getElementById('payment-pane').style.display='none';
}

function preparePayment(){
  const telegram=document.getElementById('buyer-telegram').value.trim();
  if(!telegram){ alert('Please enter your Telegram username.'); return; }
  document.getElementById('payment-pane').style.display='block';
}

// Mark as Paid
function markAsPaid(){
  // Save receipt data to sessionStorage temporarily
  const receipt = {
    orderId: 'XSN'+Date.now(),
    timestamp: new Date().toLocaleString(),
    telegram: document.getElementById('buyer-telegram').value.trim(),
    items: cart.map(i=>({title:i.title,duration:i.durationLabel,qty:i.quantity,unitPrice:i.price})),
    total: cart.reduce((s,i)=>s+i.price*i.quantity,0),
    wallet: document.getElementById('wallet-address').textContent,
    status: 'Awaiting Verification'
  };
  sessionStorage.setItem('latestReceipt', JSON.stringify(receipt));
  // Redirect to receipt page
  window.location.href='receipt.html';
}

// ---------- Recent purchase notifications ----------
const recentPurchases = [
  "@gamer123", "@playzone", "@xSuperPlayer", "@cryptoFan", "@trickyPlayer",
  "@gameOn", "@happyPlayer", "@fastGamer", "@eliteGamer", "@proPlayerX"
];

function showRandomPurchase(){
  const username = recentPurchases[Math.floor(Math.random()*recentPurchases.length)];
  const product = products[Math.floor(Math.random()*products.length)];
  const timeOffset = Math.floor(Math.random()*59)+1; // 1-59 minutes ago
  const notification = document.createElement('div');
  notification.className='notification';
  const censored = username.slice(0,3)+'***';
  notification.textContent=`${censored} just bought ${product.title} ${timeOffset} minutes ago`;
  document.getElementById('notification-container').appendChild(notification);
  setTimeout(()=>{ if(notification.parentNode) notification.parentNode.removeChild(notification); }, 8000);
  const nextTime = (Math.random()*5000)+5000; // random next between 5-10s
  setTimeout(showRandomPurchase,nextTime);
}

// ---------- Init ----------
document.addEventListener('DOMContentLoaded',()=>{
  renderProducts();
  updateCartUI();
  showRandomPurchase();
});
</script>
</body>
</html>
